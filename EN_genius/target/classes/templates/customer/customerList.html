<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/tdymeleaf/layout"
	layout:decorate="~{layout/default}">

	<th:block layout:fragment="customTitle">
		<title>EN_genius [[${title}]]</title>
	</th:block>
	
	<th:block layout:fragment="customScript">
		<script th:inline="javascript">
		
			$(document).ready(function(){
				$('#limit').val();
				$('#limit').val('10').prop('selected', true);
				searchList()
				
				var date = new Date();
				var year = ""+date.getFullYear()
				var month = ""+date.getMonth()+1
				var day = ""+date.getDate()
				if(month.length==1){
					month="0"+month
				}
				if(day.length==1){
					day="0"+day                 
				}
				var today = year+"-"+month+"-"+day
				console.log(today)
				
				$('#customerBirth1').attr('max',today)
				$('#customerBirth2').attr('max',today)
				$('#customerSign1').attr('max',today)
				$('#customerSign2').attr('max',today)
				
				$('#customerBirth1').change(function(){
					$('#customerBirth2').attr('min',$(this).val())
				})
				
				$('#customerSign2').attr('max',today)
				
				$('#customerSign1').change(function(){
					$('#customerSign2').attr('min',$(this).val())
				})
				
				$('#select').click(function(){
					searchList()
				})
				
				$('#limit').change(function(){
					searchList()
				})
			})
			
			function searchList(){
				var sid		= /*[[${session.SID}]]*/
				var ecode	= /*[[${session.ECODE}]]*/
				var scode	= /*[[${session.SCODE}]]*/
				var search={};

				search.customerName = $('#customerName').val();
				search.customerGender = $("input:radio[name='customerGender']:checked").val();
				search.customerPhone = $('#customerPhone').val();
				search.customerMemo = $('#customerMemo').val();		
				search.customerBirth1 = $('#customerBirth1').val();
				search.customerBirth2 = $('#customerBirth2').val();
				search.customerSign1 = $('#customerSign1').val();
				search.customerSign2 = $('#customerSign2').val();
				search.limit = $('#limit').val();
				
				if(sid!=null){
					search.sid	= sid;
				}else{
					search.sid	= ecode;
				}
				search.scode	= scode;
				
				var request = $.ajax({
					url : '/customerSelect',
					method : "get",
					data : search,
					dataType : "json"
				});
	
				request.done(function(data){
					table(data);
				});
	
				request.fail(function(jqXHR, textStatus) {
					alert("검색 실패!");
				})
			}
			
			function table(data) {
				var result='';
				$.each(data, function (i, l) {
					result+='<tr>';
					result+='<td>'+l.customerCode+'</td>';
					result+='<td>'+l.customerName+'</td>';
					result+='<td>'+l.customerBirth+'</td>';
					result+='<td>'+l.customerGender+'</td>';
					result+='<td>'+l.customerAddr+'</td>';
					result+='<td>'+l.customerPhone+'</td>';
					result+='<td>'+l.customerSign+'</td>';
					result+='<td>'+l.customerMemo+'</td>';
					result+='<td><a href="/customer/customerUpdate?customerCode='+l.customerCode+'">정보수정</a></td>';
					result+='</tr>';
				});
				$('tbody').html(result);
			}
			
			function pagingBtn(data) {
				
			}
		</script>
	</th:block>
	<th:block layout:fragment="contentFragment">

		<div class="card">
			<div class="card-header">
				<strong class="card-title">
					[[${title}]]
				</strong>
			</div>
			<div class="card-body">
				<div class="select">
					<div class="row">
						<div class="form-group col-lg-2" style="text-align: center">
							<label>
								고객 명
							</label>
						</div>
						<div class="form-group col-lg-4">
							<input type="text" id="customerName" name="customerName" class="form-control" placeholder="고객 명" value="">
						</div>
						<div class="form-group col-lg-2" style="text-align: center">
							<label>
								고객 성별
							</label>
						</div>
						<div class="form-group col-lg-4">
							<div class="form-control">
								<div class="row" style="text-align: center">
									<div style="width: 34%">
										<label>
											<input type="radio" name="customerGender" value="" checked="true" style="margin-left : 15px;">전체
										</label>
									</div>
									<div style="width: 33%">
										<label>
											<input type="radio" name="customerGender" value="남">남
										</label>
									</div>
									<div style="width: 33%">
										<label>
											<input type="radio" name="customerGender" value="여">여
										</label>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="form-group col-lg-2" style="text-align: center">
							<label>
								고객 메모
							</label>
						</div>
						<div class="form-group col-lg-4">
							<input type="text" id="customerMemo" name="customerMemo" class="form-control" placeholder="고객 메모">
						</div>
						<div class="form-group col-lg-2" style="text-align: center">
							<label>
								고객 연락처
							</label>
						</div>
						<div class="form-group col-lg-4">
							<input type="text" id="customerPhone" name="customerPhone" class="form-control" placeholder="고객 연락처">
						</div>
					</div>
					<div class="row">
						<div class="form-group col-lg-2" style="text-align: center">
							<label>
								고객 생일
							</label>
						</div>
						<div class="form-group col-lg-4">
							<input type="date" id="customerBirth1" name="customerBirth1" class="form-control">
						</div>
						<div class="form-group col-lg-2" style="text-align: center">
							~
						</div>
						<div class="form-group col-lg-4">
							<input type="date" id="customerBirth2" name="customerBirth2" class="form-control">
						</div>
					</div>
					<div class="row">
						<div class="form-group col-lg-2" style="text-align: center">
							<label>
								고객 등록일
							</label>
						</div>
						<div class="form-group col-lg-4">
							<input type="date" id="customerSign1" name="customerSign1" class="form-control">
						</div>
						<div class="form-group col-lg-2" style="text-align: center">
							~
						</div>
						<div class="form-group col-lg-4">
							<input type="date" id="customerSign2" name="customerSign2" class="form-control">
						</div>
					</div>
					<div class="select" style="text-align: center;">
						<button class="btn btn-success col-3" id="select">
							검색
						</button>
					</div>
				</div>
				<div>
					<select id="limit">
						<option value="3">
							3개씩 보기
						</option>
						<option value="5">
							5개씩 보기
						</option>
						<option value="10">
							10개씩 보기
						</option>
						<option value="15">
							15개씩 보기
						</option>
						<option value="20">
							20개씩 보기
						</option>
						<option value="20">
							30개씩 보기
						</option>
						<option value="20">
							40개씩 보기
						</option>
						<option value="20">
							50개씩 보기
						</option>
						<option value="20">
							100개씩 보기
						</option>
					</select>
				</div>
				<table class="table">
					<thead>
						<tr>
							<th scope="col">
								고객코드
							</th>
							<th scope="col">
								고객명
							</th>
							<th scope="col">
								고객생일
							</th>
							<th scope="col">
								고객성별
							</th>
							<th scope="col">
								고객주소
							</th>
							<th scope="col">
								고객연락처
							</th>
							<th scope="col">
								고객등록일
							</th>
							<th scope="col">
								고객메모
							</th>
							<th scope="col">
								고객수정
							</th>
						</tr>
					</thead>
					<tbody>
					</tbody>
				</table>
				<div class="paging" style="text-align: center;">
					<button>
						tt
					</button>
				</div>
			</div>
		</div>
		
	</th:block>
</html>

